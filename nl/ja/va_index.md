---

copyright:
  years: 2017
lastupdated: "2017-12-05"

---

{:new_window: target="_blank"}
{:shortdesc: .shortdesc}
{:screen: .screen}
{:pre: .pre}
{:table: .aria-labeledby="caption"}
{:codeblock: .codeblock}
{:tip: .tip} 
{:download: .download}

# 脆弱性アドバイザーを使用したイメージ・セキュリティーの管理 
{: #va_index}

脆弱性アドバイザーは、デプロイメントの前にコンテナー・イメージのセキュリティー状況を検査します。
{:shortdesc}


## 脆弱性アドバイザーの概要 
{: #about}

脆弱性アドバイザーは、{{site.data.keyword.containerlong}} のセキュリティー管理機能を提供します。脆弱性アドバイザーは、セキュリティー状況レポートを生成し、修正やベスト・プラクティスを提案し、非セキュアなイメージが実行されるのを制限するための管理機能を提供します。脆弱性アドバイザーによって報告されたセキュリティー問題や構成問題を修正することで、{{site.data.keyword.cloud_notm}} インフラストラクチャーをセキュアに保つことができます。
{:shortdesc}

脆弱性アドバイザーには、以下の機能があります。

-   イメージをスキャンして脆弱性がないか調べる
-   ISO 27002、[Center of Internet Security ![外部リンク・アイコン](../../icons/launch-glyph.svg "外部リンク・アイコン")](https://www.cisecurity.org/)などのセキュリティー規格に基づく評価レポートと、および {{site.data.keyword.containerlong_notm}} に特有のセキュリティー・プラクティスを提供する
-   ファイル・ベースのマルウェアを検出する
-   アプリケーション・タイプのサブセット用の構成ファイルをセキュアにするために推奨情報を提供する
-   レポートで報告された脆弱性や構成問題の修正方法に関する指示を提供する
   

    


**脆弱なパッケージ**

脆弱性アドバイザーは、サポートするオペレーティング・システムに基づいたイメージ内の脆弱なパッケージを検査し、その脆弱性に関連したセキュリティー上の注意事項へのリンクを提供します。 

既知の脆弱性問題があるパッケージが表示されます。以下の表にリストされた Docker イメージ・タイプに対して公開されるセキュリティー上の注意事項を元に、潜在的な脆弱性は毎日更新されます。脆弱パッケージがスキャンに合格するようにするには通常、脆弱性の修正が反映された新しいバージョンのパッケージが必要です。同じパッケージに複数の脆弱性がリストされることがあり、その場合は、1 回のパッケージのアップグレードで複数の脆弱性が修正されることがあります。**CORRECTIVE ACTION** 列に、セキュリティーを向上させる方法についての説明があります。

サポートされている基本イメージを以下の表に記載します。

  |Docker 基本イメージ|セキュリティー上の注意事項のソース|
  |-----------------|--------------------------|
  |Alpine|[Git - Alpine Linux ![外部リンク・アイコン](../../icons/launch-glyph.svg "外部リンク・アイコン")](https://git.alpinelinux.org/) および [CIRCL CVE Search ![外部リンク・アイコン](../../icons/launch-glyph.svg "外部リンク・アイコン")](https://cve.circl.lu/)|
  |CentOS| [CentOS announce archives ![外部リンク・アイコン](../../icons/launch-glyph.svg "外部リンク・アイコン")](https://lists.centos.org/pipermail/centos-announce/) および [CentOS CR announce archives ![外部リンク・アイコン](../../icons/launch-glyph.svg "外部リンク・アイコン")](https://lists.centos.org/pipermail/centos-cr-announce/)|
  |Debian|[Debian security announcements ![外部リンク・アイコン](../../icons/launch-glyph.svg "外部リンク・アイコン")](https://lists.debian.org/debian-security-announce/)|
  |Red Hat Enterprise Linux (RHEL)|[Red Hat Product Errata ![外部リンク・アイコン](../../icons/launch-glyph.svg "外部リンク・アイコン")](https://access.redhat.com/errata/#/)|
  |Ubuntu|[Ubuntu Security Notices ![外部リンク・アイコン](../../icons/launch-glyph.svg "外部リンク・アイコン")](https://www.ubuntu.com/usn/)|
  {: caption="表 1. 脆弱性アドバイザーが脆弱なパッケージについて検査する Docker 基本イメージ" caption-side="top"}
  



**アプリケーション構成**

非セキュアなイメージのアプリケーションの設定がリストされます。**CORRECTIVE ACTION** 列に、セキュリティーを向上させる方法についての説明があります。




**セキュリティー・レポート**

レジストリー・ダッシュボードの **SECURITY REPORT** 列にリポジトリーの状況が表示されます。

脆弱性アドバイザーは、以下のタイプのアプリケーションについて、構成設定における既知の脆弱性の有無を検査します。
-   MySQL
-   NGINX
-   Apache

レポートでは、イメージ用の有効なクラウド・セキュリティー・プラクティスが示されます。脆弱性アドバイザーによって検査されたセキュリティーと構成の問題に関する完全なリストにアクセスできます。

脆弱性アドバイザーのダッシュボードには、イメージのセキュリティーの概要と評価が示されます。 

脆弱性アドバイザーのダッシュボードについて詳しくは、[脆弱性レポートの検討](#va_reviewing)を参照してください。





## イメージの脆弱性レポートの検討
{: #va_reviewing}

イメージをデプロイする前に、そのイメージに関する脆弱性アドバイザー・レポートを検討できます。レポートには、脆弱なパッケージおよび非セキュアなアプリケーション設定についての詳細が示されます。
{:shortdesc}

コンテナー・イメージは、IBM またはサード・パーティーによって提供されます。あるいは、組織が追加することもできます。

以下の手順を実行して、イメージにセキュリティーと構成の問題がないかどうかを確認します。

1.  {{site.data.keyword.Bluemix_notm}} にログインします。グラフィカル・ユーザー・インターフェースで脆弱性アドバイザーを表示するには、ログインした状態である必要があります。
2.  **「カタログ」**をクリックします。
3.  **「インフラストラクチャー」**の下で**「コンテナー」**をクリックします。 
4.  **「コンテナー・レジストリー」**タイルをクリックします。
5.  **「脆弱性アドバイザー」**を展開し、**「スキャンされたリポジトリー (Scanned Repositories)」**をクリックします。 
6.  `latest` タグが付いたイメージのレポートを表示するには、そのリポジトリーの行をクリックします。レポートには、問題の総数と、問題が脆弱パッケージと構成問題のどちらなのかが示されます。リポジトリー内に `latest` タグが存在しない場合、最新のイメージが使用されます。
7.  各脆弱パッケージについての情報を表示するには、**「検出された脆弱パッケージ (Vulnerable Packages Found)」**表で **VULNERABILITIES** 列のリンクをクリックしてレポートを開きます。
    1.  詳細情報を表示するには、要約を展開します。
    2.  オペレーティング・システム・ディストリビューターの注意事項を表示するには、**OFFICIAL NOTICE** 列のリンクをクリックします。
8.  各構成問題についての情報を表示するには、**「検出された構成問題 (Configuration Issues Found)」**表で、問題の行をクリックします。 
9.  レポートに示された各問題の修正処置を実行し、イメージを再ビルドします。Dockerfile の一部の問題は、[イメージの問題の解決](#va_report)に記載されているコードを使用して解決することができます。

脆弱性が存在するのに修正しない場合、それらの問題はコンテナー用にそのイメージを使用することに影響する可能性があります。セキュリティーおよび構成に問題のあるイメージをコンテナー内で使用し続けることができます。

 




## 名前空間に保管されている Docker イメージのイメージ・セキュリティーの検討 (CLI を使用) 
{: #va_registry_cli}

{{site.data.keyword.registrylong_notm}} で名前空間に保管された Docker イメージのセキュリティーを CLI を使用して検討し、潜在的な脆弱性に関する情報を見つけることができます。
{:shortdesc}

レジストリーにイメージを追加すると、イメージは自動的に脆弱性アドバイザーによってスキャンされ、セキュリティー問題や潜在的な脆弱性が検出されます。脆弱なイメージからデプロイされたコンテナーは、アタックされたり、暗号漏えいが生じたりするおそれがあります。イメージがスキャンされるのは、そのイメージが脆弱性アドバイザーによってサポートされるオペレーティング・システムに基づいている場合のみです。

セキュリティー問題が検出された場合、報告された脆弱性を修正するための指示が出されます。

{{site.data.keyword.Bluemix_notm}} アカウント内のイメージの脆弱性の状況を検査するには、以下の手順を実行します。

1.  {{site.data.keyword.Bluemix_notm}} アカウント内のすべてのイメージをリストします。次のコマンドは、保管されている名前空間に関係なくすべてのイメージのリストを返します。

    ```
    bx cr image-list
    ```
    {: pre}

2.  **VULNERABILITY STATUS** 列で状況を確認します。以下のいずれかの状況が表示されます。
    -   `OK` この状況は、セキュリティー問題が検出されなかったことを示します。
    -   `Vulnerable` この状況は、潜在的なセキュリティー問題または脆弱性が検出されたことを示します。
    -   `Unknown` この状況は、イメージのスキャン中、最終的な脆弱性の状況を判断できるまで表示されます。
    -   `Unsupported OS` この状況は、イメージが脆弱性アドバイザーによるスキャンの対象としてサポートされていない場合に表示されます。
4.  状況の詳細を検索するには、脆弱性アドバイザーのレポートを確認します。

    ```
    bx cr va registry.<region>/<my_namespace>/<my_image>:<tag>
    ```
    {: pre}

    CLI 出力に、脆弱なパッケージのリスト、検出された脆弱性の説明、および問題の修正方法に関する指示へのリンクが示されます。


## イメージにおける一般的な問題の解決 
{: #va_report}

脆弱性アドバイザーによって報告される一般的な問題の修正例を示します。
{:shortdesc}

脆弱性アドバイザーは、報告されたセキュリティー問題や構成問題とともに、修正処置を示します。報告された問題の中には、Dockerfile を更新することで修正できるものがあります。一般的な問題を迅速に解決するために、以下のコード例を使用して、Dockerfile にソリューションを実装してください。

### パスワードの最大使用日数、パスワードの最小使用日数、およびパスワードの最小長
{: #va_password}

**問題**: 以下のエラーのいずれか、またはすべてを受け取る。

```
パスワードの最大使用日数は 90 日に設定する必要があります。
```
{: screen}

```
パスワードの最小長は 8 でなければなりません。
```
{: screen}

```
ユーザーが開始したパスワード変更の相互間に経過する必要がある最小日数は 1  でなければなりません。
```
{: screen}

**修正**: 次のコードを Dockerfile に追加することによってパスワード・コンプライアンスを設定します。

```
RUN \
    sed -i 's/^PASS_MAX_DAYS.*/PASS_MAX_DAYS    90/' /etc/login.defs && \
    sed -i 's/^PASS_MIN_DAYS.*/PASS_MIN_DAYS    1/' /etc/login.defs && \
    sed -i 's/sha512/sha512 minlen=8/' /etc/pam.d/common-password
```

### SSH 脆弱性 
{: #ssh}

**問題**: 以下のエラーが返される。

```
SSH サーバーがインストールされていてはなりません。
```
{: screen}

**修正**: SSH を使用する代わりに、`docker attach` または `docker exec` を使用してコンテナーにアクセスします。Dockerfile には SSH サーバーをインストールするためのステップが含まれていないことを確認してください。

